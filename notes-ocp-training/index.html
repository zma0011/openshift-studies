
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.2">
    
    
      
        <title>notes certification - Redhat Openshift studies</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.19190aaf.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.24b84193.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#notes-on-training" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Redhat Openshift studies" class="md-header-nav__button md-logo" aria-label="Redhat Openshift studies">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Redhat Openshift studies
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              notes certification
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/jbcodeforce/openshift-studies/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Redhat Openshift studies" class="md-nav__button md-logo" aria-label="Redhat Openshift studies">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Redhat Openshift studies
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/jbcodeforce/openshift-studies/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Kubernetes fundamentals
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Kubernetes fundamentals" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Kubernetes fundamentals
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../k8s/k8s-0/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../k8s/k8s-1/" class="md-nav__link">
      Networking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../k8s/k8s-2/" class="md-nav__link">
      Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../k8s/k8s-faq/" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../k8s/k8s-comp/" class="md-nav__link">
      Compendium
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../docker/" class="md-nav__link">
      Docker tricks
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Openshift
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Openshift" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Openshift
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../cp4i/" class="md-nav__link">
      cp4i
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../faq/" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../oc-cli/" class="md-nav__link">
      oc CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployment-ex/" class="md-nav__link">
      Deployment examples
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        notes certification
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      notes certification
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#do180" class="md-nav__link">
    DO180
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#container-technology" class="md-nav__link">
    Container technology
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openshift" class="md-nav__link">
    OpenShift
  </a>
  
    <nav class="md-nav" aria-label="OpenShift">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploying-containerized-applications-on-openshift" class="md-nav__link">
    Deploying Containerized Applications on OpenShift
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-multi-container-app" class="md-nav__link">
    Deploy multi-container app
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#s2i" class="md-nav__link">
    S2I
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerized-applications" class="md-nav__link">
    Containerized applications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compendium" class="md-nav__link">
    Compendium
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../knative/" class="md-nav__link">
      Knative
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../sre/" class="md-nav__link">
      SRE
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../spark-on-os/" class="md-nav__link">
      Operators (with Spark)
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../opendatahub/" class="md-nav__link">
      Open Data Hub
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../istio/readme/" class="md-nav__link">
      Istio
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../ansible/" class="md-nav__link">
      Ansible
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../odo-appsody/" class="md-nav__link">
      ODO - Appsody Summary
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../compendium/" class="md-nav__link">
      Compendium
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#do180" class="md-nav__link">
    DO180
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#container-technology" class="md-nav__link">
    Container technology
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openshift" class="md-nav__link">
    OpenShift
  </a>
  
    <nav class="md-nav" aria-label="OpenShift">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploying-containerized-applications-on-openshift" class="md-nav__link">
    Deploying Containerized Applications on OpenShift
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-multi-container-app" class="md-nav__link">
    Deploy multi-container app
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#s2i" class="md-nav__link">
    S2I
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerized-applications" class="md-nav__link">
    Containerized applications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compendium" class="md-nav__link">
    Compendium
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/jbcodeforce/openshift-studies/edit/master/docs/notes-ocp-training.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="notes-on-training">Notes on training</h1>
<h2 id="do180">DO180</h2>
<p>student, which has the password student, root redhat
Student workstation: workstation.lab.example.com
http://rol.redhat.com
Students also have access to a MySQL and a Nexus server hosted by either the OpenShift cluster or by AWS
github.com jbcodeforce
quay.io jbcodeforce</p>
<h2 id="container-technology">Container technology</h2>
<p>Difference between container applications and traditional deployments</p>
<ul>
<li>The major drawback to traditionally deployed software application is that the application's dependencies are entangled with the runtime environment</li>
<li>a traditionally deployed application must be stopped before updating the associated dependencies
        * complex systems to provide high availability </li>
<li>
<p>A container is a set of one or more processes that are isolated from the rest of the system. </p>
<div class="codehilite"><pre><span></span><code><span class="err">* security, storage, and network isolation</span>
<span class="err">* isolate dependent libraries and run time resources</span>
<span class="err">* less resources than VM, start quickly.</span>
<span class="err">* helps with the efficiency, elasticity, and reusability of the hosted applications, and portability</span>
<span class="err">* [Open Container initiative](https://www.opencontainers.org/)</span>
</code></pre></div>

<ul>
<li>Container image: bundle of files and metadata</li>
<li>Container engine: Rocket, Drawbridge, LXC, Docker, and Podman</li>
</ul>
</li>
<li>
<p>Started in 2001 with VServer, then move to isolated process which leverages the linux features:</p>
<div class="codehilite"><pre><span></span><code><span class="err">* **Namespaces**: The kernel can isolate specific system resources, usually visible to all processes, by placing the resources within a namespace. Namespaces can include resources like network interfaces, the process ID list, mount points, IPC resources, and the system&#39;s host name information.</span>
<span class="err">* **cgroups**: Control groups partition sets of processes and their children into groups to manage and limit the resources they consume.</span>
<span class="err">* **Seccomp** defines a security profile for processes, whitelisting the system calls, parameters and file descriptors they are allowed to use</span>
<span class="err">* SELinux (Security-Enhanced Linux) is a mandatory access control system for processes. Protect processes from each other and to protect the host system from its running processes</span>
</code></pre></div>

</li>
</ul>
<p>Example of Dockerfile</p>
<div class="highlight"><pre><span></span><code>
</code></pre></div>
<h2 id="openshift">OpenShift</h2>
<p>RHOCP adds the capabilities to provide a production PaaS platform such as remote management, multi tenancy, increased security, monitoring and auditing, application life-cycle management, and self-service interfaces for developers.</p>
<p>Username    RHT_OCP4_DEV_USER   boyerje-us
Password    RHT_OCP4_DEV_PASSWORD   &lt;&gt;
API Endpoint    RHT_OCP4_MASTER_API https://api.ocp-na2.prod.nextcle.com:6443
Console Web Application     https://console-openshift-console.apps.ocp-na2.prod.nextcle.com
Cluster ID ...</p>
<p>Container images are named based on the following syntax: <code>registry_name/user_name/image_name:tag</code></p>
<p>Example of images used:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># login to a registry</span>
sudo podman login -u username -p password registry.access.redhat.com
sudo podman run ubi7/ubi:7.7 <span class="nb">echo</span> <span class="s2">&quot;Hello!&quot;</span>
<span class="c1"># Apache http server</span>
sudo podman run -d rhscl/httpd-24-rhel7:2.4-36.8
<span class="c1"># Get IP address of a last container started</span>
podman inspect -l -f <span class="s2">&quot;{{.NetworkSettings.IPAddress}}&quot;</span> 
<span class="c1"># mysql</span>
sudo podman run --name mysql-basic -v /var/local/mysql:/var/lib/mysql/data <span class="se">\</span>
&gt; -e <span class="nv">MYSQL_USER</span><span class="o">=</span>user1 -e <span class="nv">MYSQL_PASSWORD</span><span class="o">=</span>mypa55 <span class="se">\</span>
&gt; -e <span class="nv">MYSQL_DATABASE</span><span class="o">=</span>items -e <span class="nv">MYSQL_ROOT_PASSWORD</span><span class="o">=</span>r00tpa55 <span class="se">\</span>
&gt; -d rhscl/mysql-57-rhel7:5.7-3.14
<span class="c1"># Stop and start a container</span>
sudo podman stop my-httpd-container
sudo podman restart my-httpd-container
<span class="c1"># Send a SIGKILL</span>
sudo podman <span class="nb">kill</span> my-httpd-container
</code></pre></div>
<p><strong>Quay.io</strong> introduces several features, such as server-side image building, fine-grained access controls, and automatic scanning of images for known vulnerabilities.</p>
<p>To configure registries for the podman command, you need to update the <code>/etc/containers/registries.conf</code>. The podman search command finds images from all the registries listed in this file.</p>
<div class="highlight"><pre><span></span><code>[registries.search]
registries = [&quot;registry.access.redhat.com&quot;, &quot;quay.io&quot;]
</code></pre></div>
<p>Use an FQDN and port number (5000 default) to identify a registry. </p>
<p>By default, Podman stores container images in the /var/lib/containers/storage/overlay-images directory.</p>
<p>Existing images from the Podman local storage can be saved to a .tar file using the <code>podman save</code> command.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Retrieve the list of external files and directories that Podman mounts to the running container</span>
sudo podman inspect -f <span class="s2">&quot;{{range .Mounts}}{{println .Destination}}{{end}}&quot;</span> official-httpd
<span class="c1"># list of modified files in the container file system</span>
sudo podman diff official-httpd
<span class="c1"># Commit the changes to a new container image with a new name</span>
sudo podman commit -a <span class="s1">&#39;Jerome&#39;</span> official-httpd do180-custom-httpd
sudo podman save <span class="o">[</span>-o FILE_NAME<span class="o">]</span> IMAGE_NAME<span class="o">[</span>:TAG<span class="o">]</span>
sudo podman tag quay.io/jbcodeforce/do180-custom-httpd:v1.0
sudo podman push quay.io/jbcodeforce/do180-custom-httpd:v1.0

sudo podman build -t NAME:TAG DIR

<span class="c1"># examine the content of the environment variable of a container</span>
sudo podman <span class="nb">exec</span> todoapi env
</code></pre></div>
<p>Red Hat Software Collections Library  is the source of most container images</p>
<h3 id="deploying-containerized-applications-on-openshift">Deploying Containerized Applications on OpenShift</h3>
<p>Lab:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># login to cluster </span>
oc login -u <span class="si">${</span><span class="nv">RHT_OCP4_DEV_USER</span><span class="si">}</span> -p <span class="si">${</span><span class="nv">RHT_OCP4_DEV_PASSWORD</span><span class="si">}</span> <span class="si">${</span><span class="nv">RHT_OCP4_MASTER_API</span><span class="si">}</span>
<span class="c1"># Create a new project named &quot;youruser-ocp&quot;</span>
oc new-project <span class="si">${</span><span class="nv">RHT_OCP4_DEV_USER</span><span class="si">}</span>-ocp
<span class="c1"># Create a temperature converter application written in PHP using the php:7.1 image stream tag. The source code is in the Git repository at https://github.com/RedHatTraining/DO180-apps/</span>
c new-app php:7.1~https://github.com/RedHatTraining/DO180-apps --context-dir temps --name temps
<span class="c1"># Monitor progress of the build</span>
oc logs -f bc/temps
<span class="c1"># Verify that the application is deployed.</span>
oc get pods -w
<span class="c1"># Expose the temps service to create an external route for the application.</span>
oc expose  svc/temps
<span class="c1"># Determine route URL</span>
 oc get route/temps
</code></pre></div>
<h3 id="deploy-multi-container-app">Deploy multi-container app</h3>
<p>Podman uses Container Network Interface (CNI) to create a software-defined network (SDN) between all containers in the host. Unless stated otherwise, CNI assigns a new IP address to a container when it starts.</p>
<p>Each container exposes all ports to other containers in the same SDN. As such, services are readily accessible within the same network. The containers expose ports to external networks only by explicit configuration.</p>
<p>Using environment variables allows you to share information between containers with Podman. However, there are still some limitations and some manual work involved in ensuring that all environment variables stay in sync, especially when working with many containers</p>
<p>Any service defined on Kubernetes generates environment variables for the IP address and port number where the service is available. Kubernetes automatically injects these environment variables into the containers from pods in the same namespace</p>
<p>Get the list of templates from where to create k8s resources like Secret, a Service, a PersistentVolumeClaim, and a DeploymentConfig: <code>oc get template -n openshift</code> and then from one of the template: <code>oc get template mysql-persistent -n openshift -o yaml</code>.</p>
<p>With template, you can publish a new template to the OpenShift cluster so that other developers can build an application from the template.</p>
<p>Get the parameters of a template: <code>process --parameters mysql-persistent -n openshift</code>.</p>
<p>From the template create the app resources file and then deploy the app:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># first export the template</span>
oc get template mysql-persistent -o yaml -n openshift &gt; mysql-persistent-template.yaml
<span class="c1"># identify appropriate values for the template parameters and process the template</span>
oc process -f mysql-persistent-template.yaml -p <span class="nv">MYSQL_USER</span><span class="o">=</span>dev -p <span class="nv">MYSQL_PASSWORD</span><span class="o">=</span><span class="nv">$P4SSD</span> -p <span class="nv">MYSQL_DATABASE</span><span class="o">=</span>bank -p <span class="nv">VOLUME_CAPACITY</span><span class="o">=</span>10Gi <span class="p">|</span> oc create -f -
<span class="c1"># or using new-app</span>
oc new-app --template<span class="o">=</span>mysql-persistent -p <span class="nv">MYSQL_USER</span><span class="o">=</span>dev -p <span class="nv">MYSQL_PASSWORD</span><span class="o">=</span><span class="nv">$P4SSD</span> -p <span class="nv">MYSQL_DATABASE</span><span class="o">=</span>bank -p <span class="nv">VOLUME_CAPACITY</span><span class="o">=</span>10Gi
</code></pre></div>
<p>Lab:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># login to cluster </span>
oc login -u <span class="si">${</span><span class="nv">RHT_OCP4_DEV_USER</span><span class="si">}</span> -p <span class="si">${</span><span class="nv">RHT_OCP4_DEV_PASSWORD</span><span class="si">}</span> <span class="si">${</span><span class="nv">RHT_OCP4_MASTER_API</span><span class="si">}</span>
<span class="c1"># Create a new project named &quot;youruser-&quot;</span>
oc new-project <span class="si">${</span><span class="nv">RHT_OCP4_DEV_USER</span><span class="si">}</span>-deploy
<span class="c1"># Build the MySQL Database image</span>
sudo podman build -t do180-mysql-57-rhel7 .
<span class="c1"># Push the MySQL image to the your Quay.io repository.</span>
sudo podman login quay.io -u <span class="si">${</span><span class="nv">RHT_OCP4_QUAY_USER</span><span class="si">}</span>
sudo podman tag do180-mysql-57-rhel7 quay.io/<span class="si">${</span><span class="nv">RHT_OCP4_QUAY_USER</span><span class="si">}</span>/do180-mysql-57-rhel7
sudo podman push quay.io/<span class="si">${</span><span class="nv">RHT_OCP4_QUAY_USER</span><span class="si">}</span>/do180-mysql-57-rhel7
</code></pre></div>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="s2i">S2I</h3>
<p>The S2I image creation process is composed of the build (The BuildConfig (BC) OpenShift resources drive it) and deploy (  The DeploymentConfig (OpenShift resources) steps.</p>
<ul>
<li>retrieve the logs from a build configuration: <code>oc logs bc/&lt;application-name&gt;</code></li>
<li>request a new build <code>oc start-build &lt;application-name&gt;</code></li>
<li>Deployment logs: <code>oc logs dc/&lt;appname&gt;</code></li>
</ul>
<p>If a container could not access a file system, it may come to the container running under a specific user so we need to authorize by : <code>oc adm policy add-scc-to-user anyuid -z default</code>.</p>
<ul>
<li>Make sure the ownership and permissions of the directory are set according to the USER directive in the Dockerfile that was used to build the container being deployed</li>
</ul>
<p>To avoid file system permission issues, local folders used for container volume mounts must satisfy the following:
* The user executing the container processes must be the owner of the folder
* The local folder must satisfy the SELinux requirements to be used as a container volume. Assign the container_file_t group to the folder by using the semanage fcontext -a -t container_file_t <folder> command, then refresh the permissions with the restorecon -R <folder> command.
* Run the <code>oc adm prune</code> command for an automated way to remove obsolete images and other resources.</p>
<h2 id="containerized-applications">Containerized applications</h2>
<p>To connect to a admin console of a pod, we can use: <code>oc port-forward</code> for forwarding a local port to a pod port. If the image enable remote debugging by exposing a port number, then port-forwarding, will let the IDE access the JVM to debug step by step via the Java Debug Wire Protocol (JDWP).</p>
<p>Use openshift events to see the problem at a higher level: <code>oc get events</code>.</p>
<p>To add tools like ping, telnet, iputils, dig ... into a pod, just mount local file to volume and directory like /bin, /sbin, /lib...</p>
<p>To copy file to or from a container, <code>podman cp</code> is useful, or use exec: </p>
<div class="highlight"><pre><span></span><code>sudo podman <span class="nb">exec</span> -i &lt;container&gt; mysql -uroot -proot &lt; /path/on/host/db.sql &lt; db.sql
<span class="c1"># or</span>
sudo podman <span class="nb">exec</span> -it &lt;containerName&gt; sh -c <span class="s1">&#39;exec mysqldump -h&quot;$MYSQL_PORT_3306_TCP_ADDR&quot; \</span>
<span class="s1"> -P&quot;$MYSQL_PORT_3306_TCP_PORT&quot;  -uroot -p&quot;$MYSQL_ENV_MYSQL_ROOT_PASSWORD&quot; items&#39;</span>  &gt; db_dump.sql
</code></pre></div>
<h2 id="compendium">Compendium</h2>
<ul>
<li><a href="https://www.opencontainers.org/">Open Container initiave</a></li>
<li><a href="https://podman.io/">Podman, the daemonless container engine for developing, managing, and running OCI Containers on your Linux System</a></li>
<li><a href="https://quay.io">Quay image registry</a></li>
<li><a href="https://kubernetes.io/">kubernetes</a></li>
<li><a href="https://www.openshift.com/">openshift</a></li>
<li><a href="https://rol.redhat.com/rol/app/apd.html">Git commands summary</a></li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../deployment-ex/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Deployment examples
              </div>
            </div>
          </a>
        
        
          <a href="../knative/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Knative
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.7e0ee788.min.js"></script>
      <script src="../assets/javascripts/bundle.c1ccee15.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>